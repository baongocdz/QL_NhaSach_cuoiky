USE [QL_NhaSach]
GO
/****** Object:  Table [dbo].[MATHANG]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[MATHANG](
	[MAMATHANG] [int] NOT NULL,
	[MACHINHANH] [int] NOT NULL,
	[TENMATHANG] [nvarchar](50) NULL,
	[SOLUONG] [int] NULL,
	[DONGIA] [int] NULL,
	[TACGIA] [nvarchar](50) NULL,
 CONSTRAINT [PK_MATHANG] PRIMARY KEY CLUSTERED 
(
	[MAMATHANG] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  UserDefinedFunction [dbo].[LAY_MASP2]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[LAY_MASP2]
(
    @MASP INT
)
RETURNS TABLE
AS
RETURN
(
    SELECT *
    FROM MATHANG
    WHERE MAMATHANG = @MASP
);
GO
/****** Object:  UserDefinedFunction [dbo].[LAY_THONG_TIN_SAN_PHAM]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[LAY_THONG_TIN_SAN_PHAM]
(
    @MASP INT
)
RETURNS TABLE
AS
RETURN
(
    SELECT
		S.MASACH AS MASANPHAM,
        'SACH' AS LoaiSanPham,
        S.TENSACH AS TenSanPham,
        S.TACGIA AS TacGia,
        S.SOLUONGCON AS SoLuongCon,
        S.DONGIA AS DonGia
    FROM
        SACH S
    WHERE
        S.MASACH = @MASP

    UNION ALL

    SELECT
		M.MAMATHANG AS MASANPHAM,
        'MATHANG' AS LoaiSanPham,
        M.TENMATHANG AS TenSanPham,
        '' AS TacGia, 
        M.SOLUONG AS SoLuongCon,
        M.DONGIA AS DonGia
    FROM
        MATHANG M
    WHERE
        M.MAMATHANG = @MASP
);
GO
/****** Object:  UserDefinedFunction [dbo].[LAY_MASP]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE FUNCTION [dbo].[LAY_MASP]
(
    @MASP INT
)
RETURNS TABLE
AS
RETURN
(
    SELECT *
    FROM SACH
    WHERE MASACH = @MASP
);
GO
/****** Object:  Table [dbo].[CHINHANH]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHINHANH](
	[MACHINHANH] [int] NOT NULL,
	[MATAIKHOAN] [int] NULL,
	[TEN] [nvarchar](50) NULL,
	[DIACHI] [nvarchar](50) NULL,
 CONSTRAINT [PK_CHINHANH] PRIMARY KEY CLUSTERED 
(
	[MACHINHANH] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CHITIETDOANHTHU]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHITIETDOANHTHU](
	[MACHITIETDOANHTHU] [int] NOT NULL,
	[MADOANHTHU] [int] NULL,
	[DOANHTHU] [float] NULL,
	[LUONG] [float] NULL,
	[PHUCHI] [float] NULL,
	[LOINHUAN] [float] NULL,
 CONSTRAINT [PK_CHITIETDOANHTHU] PRIMARY KEY CLUSTERED 
(
	[MACHITIETDOANHTHU] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CHITIETHOADON]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHITIETHOADON](
	[MACHITIETHOADON] [int] NOT NULL,
	[MAHOADON] [int] NULL,
	[MAMATHANG] [int] NULL,
	[SOLUONG] [int] NULL,
	[THANHTIEN] [float] NULL,
 CONSTRAINT [PK_CHITIETHOADON] PRIMARY KEY CLUSTERED 
(
	[MACHITIETHOADON] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CHITIETNHAP]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHITIETNHAP](
	[MACHITIETNHAP] [int] NOT NULL,
	[MANHAP] [int] NULL,
	[TENMATHANG] [nvarchar](50) NULL,
	[TACGIA] [nvarchar](50) NULL,
	[DONGIA] [float] NULL,
	[MAMATHANG] [int] NULL,
 CONSTRAINT [PK_CHITIETNHAP] PRIMARY KEY CLUSTERED 
(
	[MACHITIETNHAP] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[CHUCVU]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[CHUCVU](
	[MACHUCVU] [int] NOT NULL,
	[TENCHUCVU] [nvarchar](50) NULL,
	[LUONGTHEOGIO] [float] NULL,
 CONSTRAINT [PK_CHUCVU] PRIMARY KEY CLUSTERED 
(
	[MACHUCVU] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[DOANHTHU]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[DOANHTHU](
	[MADOANHTHU] [int] NOT NULL,
	[MACHINHANH] [int] NULL,
	[NGAYTHANG] [date] NULL,
 CONSTRAINT [PK_DOANHTHU] PRIMARY KEY CLUSTERED 
(
	[MADOANHTHU] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[HOADON]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[HOADON](
	[MAHOADON] [int] NOT NULL,
	[MANHANVIEN] [int] NULL,
	[NGAY] [date] NULL,
 CONSTRAINT [PK_HOADON] PRIMARY KEY CLUSTERED 
(
	[MAHOADON] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[LOAITAIKHOAN]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[LOAITAIKHOAN](
	[MALOAI] [int] NOT NULL,
	[LOAI] [nvarchar](50) NULL,
 CONSTRAINT [PK_LOAITAIKHOAN] PRIMARY KEY CLUSTERED 
(
	[MALOAI] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[NHANVIEN]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[NHANVIEN](
	[MANHANVIEN] [int] NOT NULL,
	[MACHINHANH] [int] NULL,
	[MACHUCVU] [int] NULL,
	[TEN] [nvarchar](50) NULL,
	[TONGTHOIGIANLAM] [float] NULL,
	[NGAYBATDAU] [date] NULL,
 CONSTRAINT [PK_NHANVIEN] PRIMARY KEY CLUSTERED 
(
	[MANHANVIEN] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[NHAPSACH]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[NHAPSACH](
	[MANHAP] [int] NOT NULL,
	[NGAYNHAP] [date] NULL,
	[THANHTIEN] [nchar](10) NULL,
	[MACHINHANH] [int] NULL,
 CONSTRAINT [PK_THONGKENHAP_1] PRIMARY KEY CLUSTERED 
(
	[MANHAP] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
/****** Object:  Table [dbo].[TAIKHOAN]    Script Date: 2024-04-20 1:37:45 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
CREATE TABLE [dbo].[TAIKHOAN](
	[MATAIKHOAN] [int] NOT NULL,
	[MALOAI] [int] NULL,
	[USERNAME] [nvarchar](50) NULL,
	[PASSWORD] [nvarchar](50) NULL,
	[NGAYTAO] [date] NULL,
	[TEN] [nvarchar](50) NULL,
	[MACHINHANH] [int] NULL,
 CONSTRAINT [PK_TAIKHOAN] PRIMARY KEY CLUSTERED 
(
	[MATAIKHOAN] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO
INSERT [dbo].[CHINHANH] ([MACHINHANH], [MATAIKHOAN], [TEN], [DIACHI]) VALUES (1, 1, N'NHASACHA', N'112 LE VAN MAM')
GO
INSERT [dbo].[LOAITAIKHOAN] ([MALOAI], [LOAI]) VALUES (111, N'QUANLY')
GO
INSERT [dbo].[LOAITAIKHOAN] ([MALOAI], [LOAI]) VALUES (112, N'NHANVIEN')
GO
INSERT [dbo].[MATHANG] ([MAMATHANG], [MACHINHANH], [TENMATHANG], [SOLUONG], [DONGIA], [TACGIA]) VALUES (111, 123, N'BUT', 100, 3000, NULL)
GO
INSERT [dbo].[TAIKHOAN] ([MATAIKHOAN], [MALOAI], [USERNAME], [PASSWORD], [NGAYTAO], [TEN], [MACHINHANH]) VALUES (1, 111, N'1@gmail.com', N'123', CAST(N'2024-04-12' AS Date), N'Ngoc', NULL)
GO
INSERT [dbo].[TAIKHOAN] ([MATAIKHOAN], [MALOAI], [USERNAME], [PASSWORD], [NGAYTAO], [TEN], [MACHINHANH]) VALUES (2, 112, N'2@gmail.com', N'123', CAST(N'2024-04-12' AS Date), N'Luong', NULL)
GO
INSERT [dbo].[TAIKHOAN] ([MATAIKHOAN], [MALOAI], [USERNAME], [PASSWORD], [NGAYTAO], [TEN], [MACHINHANH]) VALUES (11, 111, N'1@gmail.com', N'123', CAST(N'2024-04-12' AS Date), N'Ngoc', NULL)
GO
INSERT [dbo].[TAIKHOAN] ([MATAIKHOAN], [MALOAI], [USERNAME], [PASSWORD], [NGAYTAO], [TEN], [MACHINHANH]) VALUES (22, 112, N'2@gmail.com', N'123', CAST(N'2024-04-12' AS Date), N'Luong', NULL)
GO
INSERT [dbo].[TAIKHOAN] ([MATAIKHOAN], [MALOAI], [USERNAME], [PASSWORD], [NGAYTAO], [TEN], [MACHINHANH]) VALUES (123, NULL, N'Admin', N'123', NULL, NULL, NULL)
GO
ALTER TABLE [dbo].[CHINHANH]  WITH CHECK ADD  CONSTRAINT [FK_CHINHANH_TAIKHOAN] FOREIGN KEY([MATAIKHOAN])
REFERENCES [dbo].[TAIKHOAN] ([MATAIKHOAN])
GO
ALTER TABLE [dbo].[CHINHANH] CHECK CONSTRAINT [FK_CHINHANH_TAIKHOAN]
GO
ALTER TABLE [dbo].[CHITIETDOANHTHU]  WITH CHECK ADD  CONSTRAINT [FK_CHITIETDOANHTHU_DOANHTHU] FOREIGN KEY([MADOANHTHU])
REFERENCES [dbo].[DOANHTHU] ([MADOANHTHU])
GO
ALTER TABLE [dbo].[CHITIETDOANHTHU] CHECK CONSTRAINT [FK_CHITIETDOANHTHU_DOANHTHU]
GO
ALTER TABLE [dbo].[CHITIETHOADON]  WITH CHECK ADD  CONSTRAINT [FK_CHITIETHOADON_HOADON] FOREIGN KEY([MAHOADON])
REFERENCES [dbo].[HOADON] ([MAHOADON])
GO
ALTER TABLE [dbo].[CHITIETHOADON] CHECK CONSTRAINT [FK_CHITIETHOADON_HOADON]
GO
ALTER TABLE [dbo].[CHITIETHOADON]  WITH CHECK ADD  CONSTRAINT [FK_CHITIETHOADON_MATHANG] FOREIGN KEY([MAMATHANG])
REFERENCES [dbo].[MATHANG] ([MAMATHANG])
GO
ALTER TABLE [dbo].[CHITIETHOADON] CHECK CONSTRAINT [FK_CHITIETHOADON_MATHANG]
GO
ALTER TABLE [dbo].[CHITIETNHAP]  WITH CHECK ADD  CONSTRAINT [FK_CHITIETNHAP_MATHANG] FOREIGN KEY([MAMATHANG])
REFERENCES [dbo].[MATHANG] ([MAMATHANG])
GO
ALTER TABLE [dbo].[CHITIETNHAP] CHECK CONSTRAINT [FK_CHITIETNHAP_MATHANG]
GO
ALTER TABLE [dbo].[CHITIETNHAP]  WITH CHECK ADD  CONSTRAINT [FK_CHITIETNHAP_NHAPSACH] FOREIGN KEY([MANHAP])
REFERENCES [dbo].[NHAPSACH] ([MANHAP])
GO
ALTER TABLE [dbo].[CHITIETNHAP] CHECK CONSTRAINT [FK_CHITIETNHAP_NHAPSACH]
GO
ALTER TABLE [dbo].[DOANHTHU]  WITH CHECK ADD  CONSTRAINT [FK_DOANHTHU_CHINHANH] FOREIGN KEY([MACHINHANH])
REFERENCES [dbo].[CHINHANH] ([MACHINHANH])
GO
ALTER TABLE [dbo].[DOANHTHU] CHECK CONSTRAINT [FK_DOANHTHU_CHINHANH]
GO
ALTER TABLE [dbo].[HOADON]  WITH CHECK ADD  CONSTRAINT [FK_HOADON_NHANVIEN] FOREIGN KEY([MANHANVIEN])
REFERENCES [dbo].[NHANVIEN] ([MANHANVIEN])
GO
ALTER TABLE [dbo].[HOADON] CHECK CONSTRAINT [FK_HOADON_NHANVIEN]
GO
ALTER TABLE [dbo].[NHANVIEN]  WITH CHECK ADD  CONSTRAINT [FK_NHANVIEN_CHINHANH] FOREIGN KEY([MACHINHANH])
REFERENCES [dbo].[CHINHANH] ([MACHINHANH])
GO
ALTER TABLE [dbo].[NHANVIEN] CHECK CONSTRAINT [FK_NHANVIEN_CHINHANH]
GO
ALTER TABLE [dbo].[NHANVIEN]  WITH CHECK ADD  CONSTRAINT [FK_NHANVIEN_CHUCVU] FOREIGN KEY([MACHUCVU])
REFERENCES [dbo].[CHUCVU] ([MACHUCVU])
GO
ALTER TABLE [dbo].[NHANVIEN] CHECK CONSTRAINT [FK_NHANVIEN_CHUCVU]
GO
ALTER TABLE [dbo].[NHAPSACH]  WITH CHECK ADD  CONSTRAINT [FK_NHAPSACH_CHINHANH] FOREIGN KEY([MACHINHANH])
REFERENCES [dbo].[CHINHANH] ([MACHINHANH])
GO
ALTER TABLE [dbo].[NHAPSACH] CHECK CONSTRAINT [FK_NHAPSACH_CHINHANH]
GO
ALTER TABLE [dbo].[TAIKHOAN]  WITH CHECK ADD  CONSTRAINT [FK_TAIKHOAN_LOAITAIKHOAN] FOREIGN KEY([MALOAI])
REFERENCES [dbo].[LOAITAIKHOAN] ([MALOAI])
GO
ALTER TABLE [dbo].[TAIKHOAN] CHECK CONSTRAINT [FK_TAIKHOAN_LOAITAIKHOAN]
GO
